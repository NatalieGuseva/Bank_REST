Тесты для проекта Bankcards

Тесты разделены на следующие основные категории:

Контроллеры:
AuthControllerTest.java: Тестирование операций регистрации (/auth/register) и аутентификации (/auth/login).
CardControllerTest.java: Тестирование операций с картами, включая создание (/cards), получение списка карт (/cards), получение карты по ID (/cards/{id}), блокировку карты (/cards/{id}/block) и удаление карты (/cards/{id}).
TransferControllerTest.java: Тестирование операций перевода средств между картами (/transfers).

Сервисы:
CardServiceTest.java: Тестирование логики создания карты и валидации данных.
TransferServiceTest.java: Тестирование логики переводов между картами, включая успешные переводы и случаи с недостаточным балансом.


Директории
Тесты для контроллеров и сервисов находятся в src/test/java/com/example/bankcards.
Тестовые классы следуют структуре: <ИмяКомпонента>Test.java (например, AuthControllerTest.java).

Используемые зависимости
Тесты используют следующие зависимости, указанные в pom.xml:
JUnit 5 (junit-jupiter-api, junit-jupiter-engine) — для написания и запуска тестов.
Mockito (mockito-core, mockito-junit-jupiter) — для создания заглушек сервисов и других зависимостей.
Spring Boot Test (spring-boot-starter-test) — для поддержки тестирования REST API и контекста Spring.
Jackson (jackson-databind) — для сериализации/десериализации JSON в тестах MockMvc.

Конфигурация тестов
Аннотации:
@WebMvcTest: Используется для тестирования контроллеров, загружая только контекст, связанный с веб-слоем.
@AutoConfigureMockMvc(addFilters = false): Отключает фильтры безопасности для упрощения тестирования (например, JwtAuthenticationFilter).
@WithMockUser: Эмулирует аутентифицированного пользователя для тестов, требующих авторизации.
@InjectMocks и @Mock: Используются для внедрения заглушек сервисов и репозиториев в тесты сервисов.
@BeforeEach: Используется для инициализации тестовых данных или моков перед каждым тестом.
MockMvc: Используется для выполнения HTTP-запросов и проверки ответов (статус, тело ответа, JSON-поля).
ObjectMapper: Используется для сериализации объектов в JSON и десериализации ответов.

Особенности тестов

Контроллеры:
Тесты контроллеров проверяют HTTP-статусы, JSON-ответы и корректность вызовов сервисов.
Используются моки для AuthService, CardService, TransferService, JwtAuthenticationFilter и JwtUtil.
Пример: В AuthControllerTest тестируется успешная регистрация (возвращает HTTP 200 и сообщение "User registered successfully") и аутентификация (возвращает JWT-токен).

Сервисы:
Тесты сервисов проверяют бизнес-логику, включая валидацию данных и обработку исключений.
Пример: В TransferServiceTest проверяется успешный перевод (баланс карт обновляется) и ошибка при недостаточном балансе (ApplicationException).

Шифрование:
В CardServiceTest используется KeyGenerator для создания тестового AES-ключа, который применяется для шифрования данных карты.

Запуск тестов
Для запуска тестов используйте Maven:

Сборка проекта с тестами:
mvn clean package
Выполняет все тесты и собирает проект.

Запуск только тестов:
mvn test
Выполняет только тесты без сборки артефакта.

Пропуск тестов (при необходимости):
mvn clean package -DskipTests




